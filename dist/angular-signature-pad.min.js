angular.module("ByGiro.signaturePad",[]).directive("signaturePad",["$window","$parse","$compile",function(t,a,e){return contrFunction=["$scope","$timeout","$element","$attrs","$parse",function(t,a,e,n,o){function r(){if("function"==typeof t.opts.setModel)return void t.opts.setModel(t,n,o);if(n.modelKey&&t.$parent.model){var e=o(n.modelKey),r=e.assign;"function"==typeof r&&(r(t.$parent.model,t.dataVal),a())}}var s,i,c={height:220,width:568,clearBtn:"Cancel",setModel:!1};t.opts=angular.extend({},c,t.opts),s=e.find("canvas"),i=new SignaturePad(s.get(0),t.opts),t.signature&&!t.signature.$isEmpty&&t.signature.dataUrl&&i.fromDataURL(t.signature.dataUrl);var l=!1;e.on("mousedown touchstart",function(t){l=!0}),angular.element(document).on("mouseup touchend",function(a){l&&(l=!1,angular.equals(a.target,s[0])?(t.dataVal=i.isEmpty()?"":i.toDataURL(),r()):t.clear())}),t.clear=function(){i.clear(),t.dataVal="",r()}}],{scope:{opts:"=signaturePadOptions"},restrict:"A",replace:!0,template:'<div class=signature-container><canvas class=signature-pad height={{opts.height}} width={{opts.width}}></canvas><span class="btn btn-default btn-clear-sign" ng-click=clear()>{{opts.clearBtn}}</span></div>',controller:contrFunction}}]);