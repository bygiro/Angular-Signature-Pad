angular.module("ByGiro.signaturePad",[]).directive("signaturePad",["$window","$parse","$compile",function(t,a,e){return contrFunction=["$scope","$timeout","$element","$attrs","$parse",function(t,a,e,n,r){function i(){if("function"==typeof t.opts.setModel)return void t.opts.setModel(t,n,r);if(n.modelKey&&t.$parent.model){var e=r(n.modelKey),i=e.assign;"function"==typeof i&&(i(t.$parent.model,t.dataVal),a())}}var o,s,c={height:220,width:568,clearBtn:"Cancel",setModel:!1};t.opts=angular.extend({},c,t.opts),o=e.find("canvas"),s=new SignaturePad(o.get(0),t.opts),t.signature&&!t.signature.$isEmpty&&t.signature.dataUrl&&s.fromDataURL(t.signature.dataUrl),t.$parent.writingStarted=!1,e.on("mousedown touchstart",function(a){t.$parent.writingStarted=!0}),angular.element(document).on("mouseup touchend",function(a){t.$parent.writingStarted&&(t.$parent.writingStarted=!1,angular.equals(a.target,o[0])?(t.dataVal=s.isEmpty()?"":s.toDataURL(),i()):t.clear())}),t.clear=function(){s.clear(),t.dataVal="",i()}}],{scope:{opts:"=signaturePadOptions"},restrict:"A",replace:!0,template:'<div class=signature-container><canvas class=signature-pad height={{opts.height}} width={{opts.width}}></canvas><span class="btn btn-default btn-clear-sign" ng-click=clear()>{{opts.clearBtn}}</span></div>',controller:contrFunction}}]);